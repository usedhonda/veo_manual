# Video Extension ガイド

## 概要

Veo 3.1の動画延長機能を使って、8秒のクリップをより長い動画に拡張する方法を解説します。

**機能**:
- 既存動画の続きを生成
- 8秒 → 16秒 → 24秒... と延長可能
- 最大141秒の入力動画に対応

---

## Video Extensionの仕組み

```
┌─────────────────────────────────────────────────────────────┐
│ Video Extension の動作                                       │
│                                                             │
│  元動画（8秒）                                              │
│       ↓                                                     │
│  Veo 3.1が最終フレームを分析                                │
│       ↓                                                     │
│  継続プロンプトに基づいて続きを生成                         │
│       ↓                                                     │
│  延長された動画（+8秒）                                     │
│                                                             │
│  ※繰り返し適用で長尺化可能                                  │
└─────────────────────────────────────────────────────────────┘
```

### 重要な制約

```
【技術的制約】
- 出力解像度: 720p 固定（1080p不可）
- 入力動画: 最大141秒
- 延長単位: 8秒ずつ
- API: Video Extension専用エンドポイント

【品質に関する注意】
- 延長を重ねると一貫性が低下する可能性
- オリジナルと延長部分で微細な差異が生じうる
```

---

## 基本的なワークフロー

```
┌─────────────────────────────────────────────────────────────┐
│ 動画延長ワークフロー                                         │
│                                                             │
│  1. 元動画を生成（Phase 2で8秒）                            │
│                         ↓                                   │
│  2. 元動画をアップロード                                    │
│                         ↓                                   │
│  3. 継続プロンプトを作成                                    │
│     └→ 元動画の終了状態を記述                              │
│     └→ 続きのアクションを指示                              │
│                         ↓                                   │
│  4. Video Extensionで延長                                   │
│                         ↓                                   │
│  5. 必要に応じて繰り返し                                    │
└─────────────────────────────────────────────────────────────┘
```

---

## 継続プロンプトの作成

### Geminiへの依頼テンプレート

```
Veo 3.1のVideo Extension用プロンプトを生成してください。

【元動画の状態】
- 終了時の状況: [最終フレームの状態]
- キャラクター/被写体: [何がどの位置にいるか]
- カメラ: [カメラの状態]

【継続する内容】
- 次のアクション: [何が起きるか]
- カメラワーク: [動きの継続/変化]
- 雰囲気: [維持/変化]

【一貫性の維持】
- ライティング: [同じ/変化]
- スタイル: [同じ]
- キャラクター: [同じ外見]

【オーディオ】
- 継続するか、変化するか
```

---

## 具体的な依頼例

### 例1: アクションの継続

```
【元動画】
- 女性が走っている途中
- 廊下を走る、左から右へ
- カメラはサイドからのトラッキング

【継続】
- 走り続けて角を曲がる
- カメラは追従を続ける
- 息遣いと足音が続く

【一貫性】
- 同じ服装、髪型
- 同じライティング
- 同じスピード感
```

**生成されるプロンプト例**:
```
Continuing seamlessly from previous clip:
Woman continues running down the hallway,
same tracking shot follows from side,
she turns the corner to the right,
maintain running speed and urgency,
same lighting conditions and visual style,
SFX: footsteps continue, breathing
```

### 例2: シーンの展開

```
【元動画】
- 夕日を見ている人物の背中
- 静止ショット
- 太陽が沈みかけ

【継続】
- 太陽がさらに沈む
- 人物が振り向く
- 空の色が変化

【一貫性】
- 同じ人物
- 同じロケーション
- 連続した時間経過
```

### 例3: 製品動画の延長

```
【元動画】
- 製品が180度回転
- オービットの途中
- 右側が見えている

【継続】
- 残りの180度を回転
- フルオービット完了
- 同じスピードで

【一貫性】
- 同じライティング
- 同じ背景
- 同じ製品位置
```

---

## 一貫性を保つコツ

### 1. 終了状態の正確な記述

```
【重要ポイント】
元動画の最終フレームを詳細に記述:
- 被写体の位置
- カメラの位置・角度
- ライティングの方向
- 現在のアクション状態
```

### 2. 継続性キーワード

```
【使用すべきキーワード】
- "Continuing seamlessly"
- "Maintaining consistency"
- "Same lighting conditions"
- "Same visual style"
- "Smooth continuation"
```

### 3. ネガティブプロンプト

```json
{
  "negative": {
    "exclude": [
      "discontinuity",
      "jump cut",
      "sudden change",
      "style shift",
      "lighting change",
      "costume change"
    ]
  }
}
```

---

## 複数回延長の注意点

### 品質の維持

```
【推奨】
- 2-3回の延長まで（24-32秒）
- 各延長で元動画との一貫性を確認
- 問題があれば早めに再生成

【注意】
- 延長を重ねると一貫性が低下しやすい
- 5回以上の延長は品質リスクが高い
- 長尺が必要な場合は複数クリップ方式を検討
```

### 延長vs複数クリップ

```
【Video Extension が適切な場合】
- 連続した動きの延長
- 同じシーンの継続
- カメラワークが一定

【複数クリップが適切な場合】
- シーンの切り替え
- 異なるカメラアングル
- 長いストーリー（編集で繋ぐ）
```

---

## APIでの使用

### リクエスト形式

```json
{
  "model": "veo-3.1-generate-001",
  "input": {
    "video": {
      "gcsUri": "gs://bucket/original-video.mp4"
    }
  },
  "config": {
    "extensionDurationSeconds": 8
  },
  "prompt": "Continuing seamlessly: ..."
}
```

### レスポンス

```json
{
  "name": "projects/.../operations/...",
  "metadata": {
    "state": "RUNNING"
  }
}
```

---

## トラブルシューティング

### 問題: 繋ぎ目が不自然

```
【原因】
- 終了状態の記述が不正確
- 動きの方向が矛盾

【対策】
- 元動画の最終フレームを詳細に記述
- 「continuing seamlessly」を強調
- 動きの方向と速度を明示
```

### 問題: スタイルが変わる

```
【原因】
- スタイル指定の不足
- 元動画との整合性欠如

【対策】
- 元動画と同じスタイルキーワードを使用
- ネガティブに「style shift」追加
```

### 問題: キャラが変わる

```
【原因】
- キャラ特徴の記述不足
- 一貫性指示の不足

【対策】
- キャラの特徴を再記述
- 「same character appearance」を追加
- ネガティブに「different character」追加
```

### 問題: 720pしか出ない

```
【説明】
これはVideo Extensionの仕様上の制限です。
高解像度が必要な場合は、最初から複数の
8秒クリップを生成して編集で繋ぐ方法を推奨。
```

---

## ベストプラクティス

### 1. 計画的な延長

```
【事前に決める】
- 最終的な長さ
- 各セグメントの内容
- 延長回数の上限
```

### 2. 各延長の品質確認

```
【確認ポイント】
- 繋ぎ目は自然か
- スタイルは一貫しているか
- キャラ/被写体は同じか
- ライティングは維持されているか
```

### 3. 代替案の検討

```
【720p制限が問題の場合】
1. 複数の1080pクリップを生成
2. 編集ソフトで結合
3. トランジションで自然に繋ぐ
```

---

## 次に読む

- **複数ショットの結合**: `02-multi-shot-sequence.md`
- **トランジション**: `03-transitions.md`
- **トラブルシューティング**: `../troubleshooting.md`
